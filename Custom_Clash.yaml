# ==============================================
# Clash (mihomo) é…ç½®æ¨¡æ¿
# è½¬æ¢è‡ª Custom_QX.conf
# ==============================================

# ====== åŸºç¡€è®¾ç½® ======
port: 7890
socks-port: 7891
mixed-port: 7893
allow-lan: true
bind-address: "*"
mode: rule
log-level: info
external-controller: 127.0.0.1:9090
unified-delay: true
tcp-concurrent: true
find-process-mode: strict
global-client-fingerprint: chrome

# ====== DNS ======
dns:
  enable: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - "*.lan"
    - localhost.ptlogin2.qq.com
    - "+.srv.nintendo.net"
    - "+.stun.playstation.net"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.xboxlive.com"
    - msftconnecttest.com
    - xbox.*.microsoft.com
    - "*.battlenet.com.cn"
    - "*.logon.battlenet.com"
  nameserver:
    - 119.29.29.29
    - 223.5.5.5
  fallback:
    - tls://1.1.1.1:853
    - tls://8.8.8.8:853
  fallback-filter:
    geoip: true
    geoip-code: CN

proxies: # {{proxies}}

# ====== ç­–ç•¥ç»„ ======
proxy-groups:
  # ------ åŸºç¡€ç­–ç•¥ ------
  - name: Outside
    type: select
    proxies:
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US
      - DIRECT

  - name: AI Suite
    type: select
    proxies:
      - Outside
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  # ------ æµåª’ä½“ ------
  - name: Netflix
    type: select
    proxies:
      - Global Media
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  - name: Global Media
    type: select
    proxies:
      - Outside
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US
      - DIRECT

  - name: TikTok
    type: select
    proxies:
      - Outside
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  # ------ æœåŠ¡ ------
  - name: Apple
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  - name: GitHub
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  - name: Telegram
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  - name: Mail
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  # ------ é‡‘è ------
  - name: Crypto
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  - name: PayPal
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  - name: Stripe
    type: select
    proxies:
      - Outside
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  # ------ å·¥å…· ------
  - name: Speedtest
    type: select
    proxies:
      - DIRECT
      - ğŸ‡­ğŸ‡° HK
      - ğŸ‡¼ğŸ‡¸ TW
      - ğŸ‡¸ğŸ‡¬ SG
      - ğŸ‡¯ğŸ‡µ JP
      - ğŸ‡ºğŸ‡² US

  # ------ å…œåº• ------
  - name: Others
    type: select
    proxies:
      - Outside
      - DIRECT

  # ------ åœ°åŒºèŠ‚ç‚¹ç»„ ------
  - name: ğŸ‡­ğŸ‡° HK
    type: url-test
    url: http://cp.cloudflare.com/generate_204
    interval: 300
    tolerance: 50
    filter: "(?!.*(Game))(æ¸¯|Hong|HK)"
    proxies: []

  - name: ğŸ‡¸ğŸ‡¬ SG
    type: select
    filter: "(?!.*(Game))(æ–°|Singapore|SG)"
    proxies: []

  - name: ğŸ‡¼ğŸ‡¸ TW
    type: fallback
    url: http://cp.cloudflare.com/generate_204
    interval: 300
    filter: "(?!.*(Game))(å°|Tai|TW)"
    proxies: []

  - name: ğŸ‡ºğŸ‡² US
    type: select
    filter: "(?!.*(Game))(ç¾|States|US)"
    proxies: []

  - name: ğŸ‡¯ğŸ‡µ JP
    type: select
    filter: "(?!.*(Game))(æ—¥|Japan|JP)"
    proxies: []

# ====== è¿œç¨‹è§„åˆ™é›† ======
rule-providers:
  # 1. å¹¿å‘Šæ‹¦æˆª
  AWAvenue-Ads:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/TG-Twilight/AWAvenue-Ads-Rule@main/Filters/AWAvenue-Ads-Rule-Clash.yaml"
    path: ./ruleset/AWAvenue-Ads.yaml
    interval: 172800

  # 2. ç›´è¿è¦†ç›–
  China-Media:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaMedia/ChinaMedia.yaml"
    path: ./ruleset/China-Media.yaml
    interval: 172800

  # 3. AI æœåŠ¡
  Claude:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Claude/Claude.yaml"
    path: ./ruleset/Claude.yaml
    interval: 172800

  OpenAI:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/OpenAI/OpenAI.yaml"
    path: ./ruleset/OpenAI.yaml
    interval: 172800

  # 4. æµåª’ä½“
  Netflix:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Netflix/Netflix.yaml"
    path: ./ruleset/Netflix.yaml
    interval: 172800

  TikTok:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/TikTok/TikTok.yaml"
    path: ./ruleset/TikTok.yaml
    interval: 172800

  YouTube:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/YouTube/YouTube.yaml"
    path: ./ruleset/YouTube.yaml
    interval: 172800

  Global-Media:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GlobalMedia/GlobalMedia.yaml"
    path: ./ruleset/Global-Media.yaml
    interval: 172800

  # 5. æœåŠ¡ & å·¥å…·
  Apple:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Apple/Apple.yaml"
    path: ./ruleset/Apple.yaml
    interval: 172800

  GitHub:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/GitHub/GitHub.yaml"
    path: ./ruleset/GitHub.yaml
    interval: 172800

  Telegram:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Telegram/Telegram.yaml"
    path: ./ruleset/Telegram.yaml
    interval: 172800

  Mail:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Mail/Mail.yaml"
    path: ./ruleset/Mail.yaml
    interval: 172800

  # 6. é‡‘è
  Crypto:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/nicedayzhu/clash_rules@master/Crypto.yaml"
    path: ./ruleset/Crypto.yaml
    interval: 172800

  PayPal:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/PayPal/PayPal.yaml"
    path: ./ruleset/PayPal.yaml
    interval: 172800

  Stripe:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Stripe/Stripe.yaml"
    path: ./ruleset/Stripe.yaml
    interval: 172800

  # 7. å·¥å…·
  Speedtest:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Speedtest/Speedtest.yaml"
    path: ./ruleset/Speedtest.yaml
    interval: 172800

  # 8. å…œåº•
  Proxy:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Proxy/Proxy.yaml"
    path: ./ruleset/Proxy.yaml
    interval: 172800

  China:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/China/China.yaml"
    path: ./ruleset/China.yaml
    interval: 172800

  ChinaASN:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/ChinaASN/ChinaASN_Domain.yaml"
    path: ./ruleset/ChinaASN.yaml
    interval: 172800

  LAN:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/blackmatrix7/ios_rule_script@master/rule/Clash/Lan/Lan.yaml"
    path: ./ruleset/LAN.yaml
    interval: 172800

# ====== åˆ†æµè§„åˆ™ ======
rules:
  # 1. å¹¿å‘Šæ‹¦æˆªï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
  - RULE-SET,AWAvenue-Ads,REJECT

  # 2. ç›´è¿è¦†ç›–ï¼ˆé˜²æ­¢è¢«åç»­ä»£ç†è§„åˆ™è¯¯åŒ¹é…ï¼‰
  - RULE-SET,China-Media,DIRECT

  # 3. AI æœåŠ¡
  - RULE-SET,Claude,AI Suite
  - RULE-SET,OpenAI,AI Suite

  # 4. æµåª’ä½“
  - RULE-SET,Netflix,Netflix
  - RULE-SET,TikTok,TikTok
  - RULE-SET,YouTube,Global Media
  - RULE-SET,Global-Media,Global Media

  # 5. æœåŠ¡ & å·¥å…·
  - RULE-SET,Apple,Apple
  - RULE-SET,GitHub,GitHub
  - RULE-SET,Telegram,Telegram
  - RULE-SET,Mail,Mail

  # 6. é‡‘è
  - RULE-SET,Crypto,Crypto
  - RULE-SET,PayPal,PayPal
  - RULE-SET,Stripe,Stripe

  # 7. å·¥å…·
  - RULE-SET,Speedtest,Speedtest

  # 8. å…œåº•ï¼ˆå›½å†…ç›´è¿ â†’ æµ·å¤–ä»£ç† â†’ LANï¼‰
  - RULE-SET,Proxy,Outside
  - RULE-SET,China,DIRECT
  - RULE-SET,ChinaASN,DIRECT
  - RULE-SET,LAN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,Others
